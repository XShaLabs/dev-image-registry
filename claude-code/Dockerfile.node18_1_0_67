FROM node:18

RUN apt-get update && apt-get install -y git bash && rm -rf /var/lib/apt/lists/*

WORKDIR /app

RUN npm install -g pnpm @anthropic-ai/claude-code@1.0.67

RUN groupadd -g 1001 -r xsha && \
    useradd -u 1001 -r -m -g xsha xsha && \
    mkdir /app && \
    chown -R xsha:xsha /app

USER xsha